<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DzTeck.ai - منصة المحادثة الذكية</title>
    <meta name="description" content="DzTeck.ai - تحدث مع أحدث نماذج الذكاء الاصطناعي باللغة العربية">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Favicon (optional but recommended) -->
    <!-- <link rel="icon" href="{{ url_for('static', filename='img/favicon.ico') }}"> -->
</head>
<body>
    <div class="chat-container">
        <!-- الهيدر الأصلي لصفحة الفهرس -->
        <header class="chat-header index-header">
            <div class="header-left">
                <h1 class="rahmani-credit">Created by <span>Rahmani</span></h1>
            </div>
            <div class="header-right">
                 <img src="{{ url_for('static', filename='img/logo.svg') }}" alt="DzTeck Logo" class="logo-img" onerror="this.style.display='none'">
                <span class="brand-name">DzTeck.ai</span>
            </div>
        </header>

        <main class="main-content">
            <h2><i class="fas fa-comments"></i> محادثاتك</h2>
            {% if chats and chats|length > 0 %}
            <div class="chat-list">
                {% for chat in chats %}
                {# ** الخادم يجب أن يمرر chat.id, chat.title, chat.updated_at ** #}
                <a href="{{ url_for('view_chat', chat_id=chat.id) }}" class="chat-item" title="فتح محادثة: {{ chat.title | default('محادثة بدون عنوان') }}">
                    <span class="chat-title">{{ chat.title | default('محادثة بدون عنوان') }}</span>
                    <span class="chat-date">
                        <i class="far fa-clock"></i> {{ chat.updated_at.strftime('%Y/%m/%d') if chat.updated_at else '--' }}
                    </span>
                </a>
                {% endfor %}
            </div>
            {% else %}
             <p class="no-chats-message">ابدأ محادثة جديدة لاستكشاف إمكانيات الذكاء الاصطناعي!</p>
            {% endif %}

            <!-- نموذج إنشاء محادثة جديدة -->
            <form action="{{ url_for('create_chat') }}" method="post" class="new-chat-form">
                 <div class="model-selector">
                    <label for="model-select">اختر نموذج الذكاء الاصطناعي للبدء:</label>
                    <select id="model-select" name="model" required>
                        {# ** يجب أن تأتي هذه الخيارات من الخادم أو تكون محدثة ** #}
                        <option value="mistralai/mistral-7b-instruct-v0.2">Mistral 7B (سريع ومجاني)</option>
                        <option value="google/gemma-7b-it">Google Gemma 7B (مجاني)</option>
                        <option value="anthropic/claude-3-haiku">Claude 3 Haiku (متوازن)</option>
                        <option value="openai/gpt-3.5-turbo">GPT-3.5 Turbo (شائع)</option>
                        <option value="meta-llama/llama-3-8b-instruct">Llama 3 8B (الأحدث)</option>
                         <option value="nousresearch/nous-hermes-2-mistral-7b-dpo">Nous Hermes 2 (مجاني)</option>
                    </select>
                </div>
                <button type="submit" class="new-chat-button">
                    <i class="fas fa-plus-circle"></i> بدء محادثة جديدة
                </button>
            </form>

            <div class="info-banner">
                <p><i class="fas fa-info-circle"></i> اكتشف قوة الذكاء الاصطناعي بلغتك الأم. DzTeck.ai يربطك بأفضل النماذج العالمية.</p>
                <a href="#" class="download-app-button" onclick="alert('التطبيق قيد التطوير حالياً!'); return false;">
                    <i class="fas fa-mobile-alt"></i> تحميل تطبيق DzTeck (قريباً)
                </a>
            </div>
        </main>

        <!-- الفوتر الأصلي -->
        <footer class="chat-footer">
            <p>© {{ now.year if now else '2024' }} DzTeck.ai - All rights reserved by Rahmani</p>
            <p class="footer-tagline">الذكاء الاصطناعي يتحدث العربية بطلاقة.</p>
        </footer>
    </div>
</body>
</html>
